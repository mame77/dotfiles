# =======================
# プレフィックスキー設定
# =======================
# プレフィックスをCtrl+aに変更（Ctrl+bより押しやすい）
set -g prefix C-a
unbind C-b
# Ctrl+aを2回押すとアプリケーションにCtrl+aを送信
bind C-a send-prefix

# =======================
# 基本設定
# =======================
# マウス操作を有効化
set -g mouse on

# ウィンドウとペインの番号を1から開始（0より直感的）
set -g base-index 1
set -g pane-base-index 1

# ウィンドウ番号を自動で詰める
set -g renumber-windows on

# エスケープキーの遅延を短縮
set -s escape-time 0

# 履歴を10,000行保持
set -g history-limit 10000

# 256色対応
set -g default-terminal "screen-256color"
set -ga terminal-overrides ",xterm-256color:Tc"

# =======================
# キーバインド
# =======================
# 設定ファイルのリロード
bind r source-file ~/.config/tmux/tmux.conf \; display "設定をリロードしました"

# ペイン分割をより直感的に
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"

# Vimライクなペイン移動
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Alt+矢印キーでペイン移動（プレフィックス不要）
bind -n M-Left select-pane -L
bind -n M-Right select-pane -R
bind -n M-Up select-pane -U
bind -n M-Down select-pane -D

# ペインサイズ調整
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# ウィンドウの移動
bind -r < swap-window -d -t -1
bind -r > swap-window -d -t +1

# コピーモードをVimライクに
setw -g mode-keys vi
bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "pbcopy"
bind -T copy-mode-vi C-v send-keys -X rectangle-toggle

# =======================
# ステータスバー設定
# =======================
# ステータスバーを上部に表示
set -g status-position top

# ステータスバーの更新間隔（秒）
set -g status-interval 5

# ステータスバーの色とスタイル
set -g status-style 'bg=#333333 fg=#ffffff'
set -g status-left-length 40
set -g status-right-length 80

# 左側：セッション名とホスト名
set -g status-left '#[bg=#87ceeb,fg=#000000,bold] #S #[bg=#333333] #h '

# 右側：日時とロードアベレージ
set -g status-right '#[fg=#87ceeb]#(uptime | cut -d "," -f 3- | sed "s/.*load average: //") #[fg=#ffffff]| %Y-%m-%d %H:%M'

# ウィンドウリストの色
setw -g window-status-style 'fg=#888888'
setw -g window-status-current-style 'bg=#87ceeb,fg=#000000,bold'
setw -g window-status-format ' #I:#W '
setw -g window-status-current-format ' #I:#W '

# ペイン境界線の色
set -g pane-border-style 'fg=#444444'
set -g pane-active-border-style 'fg=#87ceeb'

# =======================
# ウィンドウ・ペイン設定
# =======================
# ウィンドウ名の自動変更を無効
setw -g automatic-rename off

# アクティビティ監視
setw -g monitor-activity on
set -g visual-activity on

# 新しいウィンドウを現在のディレクトリで作成
bind c new-window -c "#{pane_current_path}"

# =======================
# プラグイン設定（オプション）
# =======================
# TPM (Tmux Plugin Manager) を使用する場合
# set -g @plugin 'tmux-plugins/tpm'
# set -g @plugin 'tmux-plugins/tmux-sensible'
# set -g @plugin 'tmux-plugins/tmux-resurrect'
# set -g @plugin 'tmux-plugins/tmux-continuum'

# プラグインの初期化（最後に配置）
# run '~/.tmux/plugins/tpm/tpm'
